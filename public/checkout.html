<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout | The Grasshopper</title>
    <meta name="description" content="Secure checkout - The Grasshopper salon-quality hair care products">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,500;1,400&family=Outfit:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script type="text/javascript" src="https://web.squarecdn.com/v1/square.js"></script>
</head>
<body class="shop-page">
    <nav class="nav nav-light">
        <div class="nav-container">
            <a href="index.html" class="nav-logo">The Grasshopper</a>
            <div class="nav-links">
                <a href="index.html" class="nav-link">Home</a>
                <a href="shop.html" class="nav-link">Shop</a>
            </div>
            <div class="nav-actions">
                <button class="nav-hamburger" aria-label="Menu">
                    <span></span><span></span><span></span>
                </button>
            </div>
        </div>
    </nav>

    <div class="mobile-menu-overlay"></div>
    <div class="mobile-menu">
        <button class="mobile-menu-close">&times;</button>
        <a href="index.html" class="mobile-menu-link">Home</a>
        <a href="shop.html" class="mobile-menu-link">Shop</a>
        <a href="hair-analysis.html" class="mobile-menu-link">Hair Analysis</a>
        <a href="tel:8446215787" class="mobile-menu-link">(844) 621-5787</a>
    </div>

    <main class="checkout-page">
        <div class="checkout-container">
            <h1 class="checkout-title">Checkout</h1>

            <div class="checkout-layout">
                <!-- Order Summary -->
                <div class="checkout-summary">
                    <h2 class="checkout-section-title">Order Summary</h2>
                    <div class="checkout-items" id="checkoutItems">
                        <div class="loading-spinner"><div class="spinner"></div></div>
                    </div>

                    <!-- Promo Code -->
                    <div class="checkout-promo">
                        <div class="promo-input-row">
                            <input type="text" id="promoInput" class="promo-input" placeholder="Promo code">
                            <button id="promoApplyBtn" class="promo-apply-btn" onclick="applyPromo()">Apply</button>
                            <button id="promoRemoveBtn" class="promo-remove-btn" onclick="removePromo()" style="display: none;">Remove</button>
                        </div>
                        <p id="promoMessage" class="promo-message"></p>
                    </div>

                    <div class="checkout-totals">
                        <div class="checkout-line">
                            <span>Subtotal</span>
                            <span id="checkoutSubtotal">$0.00</span>
                        </div>
                        <div class="checkout-line" id="discountLine" style="display: none;">
                            <span>Discount</span>
                            <span id="checkoutDiscount" class="discount-amount">-$0.00</span>
                        </div>
                        <div class="checkout-line">
                            <span>Shipping</span>
                            <span id="checkoutShipping">Calculating...</span>
                        </div>
                        <div class="checkout-line">
                            <span>Tax (NC 7.25%)</span>
                            <span id="checkoutTax">$0.00</span>
                        </div>
                        <div class="checkout-line checkout-total-line">
                            <span>Total</span>
                            <span id="checkoutTotal">$0.00</span>
                        </div>
                    </div>
                </div>

                <!-- Payment Section -->
                <div class="checkout-payment">
                    <!-- Shipping Address (hidden for pickup) -->
                    <div id="addressSection">
                        <h2 class="checkout-section-title">Shipping Address</h2>
                        <div class="checkout-address-form">
                            <div class="address-row">
                                <div class="address-field">
                                    <label for="addrFirstName">First Name</label>
                                    <input type="text" id="addrFirstName" required>
                                </div>
                                <div class="address-field">
                                    <label for="addrLastName">Last Name</label>
                                    <input type="text" id="addrLastName" required>
                                </div>
                            </div>
                            <div class="address-field">
                                <label for="addrEmail">Email</label>
                                <input type="email" id="addrEmail" required>
                            </div>
                            <div class="address-field">
                                <label for="addrStreet">Street Address</label>
                                <input type="text" id="addrStreet" required>
                            </div>
                            <div class="address-field">
                                <label for="addrApt">Apt / Suite (optional)</label>
                                <input type="text" id="addrApt">
                            </div>
                            <div class="address-row address-row-3">
                                <div class="address-field">
                                    <label for="addrCity">City</label>
                                    <input type="text" id="addrCity" required>
                                </div>
                                <div class="address-field address-field-sm">
                                    <label for="addrState">State</label>
                                    <select id="addrState" required>
                                        <option value="">--</option>
                                        <option value="AL">AL</option><option value="AK">AK</option><option value="AZ">AZ</option><option value="AR">AR</option>
                                        <option value="CA">CA</option><option value="CO">CO</option><option value="CT">CT</option><option value="DE">DE</option>
                                        <option value="FL">FL</option><option value="GA">GA</option><option value="HI">HI</option><option value="ID">ID</option>
                                        <option value="IL">IL</option><option value="IN">IN</option><option value="IA">IA</option><option value="KS">KS</option>
                                        <option value="KY">KY</option><option value="LA">LA</option><option value="ME">ME</option><option value="MD">MD</option>
                                        <option value="MA">MA</option><option value="MI">MI</option><option value="MN">MN</option><option value="MS">MS</option>
                                        <option value="MO">MO</option><option value="MT">MT</option><option value="NE">NE</option><option value="NV">NV</option>
                                        <option value="NH">NH</option><option value="NJ">NJ</option><option value="NM">NM</option><option value="NY">NY</option>
                                        <option value="NC">NC</option><option value="ND">ND</option><option value="OH">OH</option><option value="OK">OK</option>
                                        <option value="OR">OR</option><option value="PA">PA</option><option value="RI">RI</option><option value="SC">SC</option>
                                        <option value="SD">SD</option><option value="TN">TN</option><option value="TX">TX</option><option value="UT">UT</option>
                                        <option value="VT">VT</option><option value="VA">VA</option><option value="WA">WA</option><option value="WV">WV</option>
                                        <option value="WI">WI</option><option value="WY">WY</option><option value="DC">DC</option>
                                    </select>
                                </div>
                                <div class="address-field address-field-sm">
                                    <label for="addrZip">ZIP</label>
                                    <input type="text" id="addrZip" maxlength="5" required>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h2 class="checkout-section-title">Payment</h2>

                    <!-- Wallet Buttons (Apple Pay / Google Pay) -->
                    <div id="walletButtons" class="checkout-wallet-buttons" style="display: none;">
                        <button id="apple-pay-button" class="apple-pay-button" style="display: none;"></button>
                        <div id="google-pay-button" class="wallet-button-container"></div>
                        <div class="checkout-divider">
                            <span>or pay with card</span>
                        </div>
                    </div>

                    <!-- Card Payment -->
                    <div id="card-container" class="checkout-card-container"></div>

                    <button id="payButton" class="checkout-pay-btn" disabled>
                        <span class="pay-btn-text">Pay Now</span>
                        <span class="pay-btn-loading" style="display: none;">
                            <span class="pay-spinner"></span>
                            Processing...
                        </span>
                    </button>

                    <div id="paymentErrors" class="checkout-errors" style="display: none;"></div>

                    <div class="checkout-secure-note">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                            <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                        </svg>
                        <span>Payments are securely processed by Square</span>
                    </div>
                </div>
            </div>

            <!-- Success State -->
            <div id="checkoutSuccess" class="checkout-success" style="display: none;">
                <div class="success-icon">
                    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                        <polyline points="22 4 12 14.01 9 11.01"/>
                    </svg>
                </div>
                <h2 class="success-title">Order Confirmed!</h2>
                <p class="success-message" id="successMessage">Thank you for your purchase. You'll receive a confirmation email shortly.</p>
                <a href="shop.html" class="success-continue-btn">Continue Shopping</a>
                <a id="receiptLink" href="#" class="success-receipt-link" style="display: none;" target="_blank">View Receipt</a>
            </div>

            <!-- Error State -->
            <div id="checkoutError" class="checkout-error-state" style="display: none;">
                <h2>Something went wrong</h2>
                <p id="errorMessage">We couldn't process your payment. Please try again.</p>
                <button onclick="location.reload()" class="checkout-retry-btn">Try Again</button>
            </div>
        </div>
    </main>

    <footer class="footer footer-light">
        <div class="footer-main">
            <div class="footer-brand">
                <span class="footer-logo">The Grasshopper</span>
                <p class="footer-tagline">Professional hair care curated by a stylist with 32 years of experience</p>
            </div>
            <div class="footer-links">
                <h4>Shop</h4>
                <a href="shop.html">All Products</a>
                <a href="about.html">About D'yette</a>
            </div>
            <div class="footer-links">
                <h4>Contact</h4>
                <a href="tel:8446215787">(844) 621-5787</a>
                <a href="https://www.instagram.com/dyette_grasshopper/" target="_blank">Instagram</a>
            </div>
            <div class="footer-links">
                <h4>Info</h4>
                <a href="policies.html#shipping">Shipping Policy</a>
                <a href="policies.html#returns">Returns</a>
            </div>
        </div>
        <div class="footer-bottom">
            <p>1515 Burtonwood Cir, Charlotte, NC</p>
            <p>&copy; 2026 The Grasshopper. All rights reserved.</p>
        </div>
    </footer>

    <script src="payment.js?v=2"></script>
    <script>
        // Mobile menu
        document.querySelector('.nav-hamburger')?.addEventListener('click', () => {
            document.querySelector('.mobile-menu')?.classList.add('active');
            document.querySelector('.mobile-menu-overlay')?.classList.add('active');
            document.body.style.overflow = 'hidden';
        });
        document.querySelector('.mobile-menu-close')?.addEventListener('click', closeMobileMenu);
        document.querySelector('.mobile-menu-overlay')?.addEventListener('click', closeMobileMenu);

        function closeMobileMenu() {
            document.querySelector('.mobile-menu')?.classList.remove('active');
            document.querySelector('.mobile-menu-overlay')?.classList.remove('active');
            document.body.style.overflow = '';
        }
    </script>
</body>
</html>
